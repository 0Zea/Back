import{_ as B,b as r,f as C,k as F,l as I,u as M,o as n,a as e,c as i,m as V,d as p,w as f,v as m}from"./index-CYcq9FJg.js";import{U as S}from"./UserCardLayout-kpRO1Q3F.js";import{i as y}from"./index-B_YT07cM.js";async function D(l,o){try{return(await y.post("/api/auth/verify-user",{phoneNum:l,email:o})).data.success}catch(t){return console.error("사용자 정보 확인 실패:",t),!1}}async function E(l){try{return(await y.post("/api/auth/send-verification-code",{email:l})).data.success}catch(o){throw console.error("인증번호 발송 실패:",o),o}}async function L(l,o){try{return(await y.post("/api/auth/verify-code",{code:l,email:o})).data.success}catch(t){return console.error("인증번호 확인 실패:",t),!1}}async function R(l,o){try{return(await y.post("/api/auth/change-password",{email:l,newPassword:o})).data.success}catch(t){throw console.error("비밀번호 변경 실패:",t),t}}const T={class:"form-group"},j={class:"form-group"},q={class:"input-row"},z={key:0,class:"error-msg"},A={key:1,class:"success-msg"},G={key:0,class:"form-group"},H={class:"input-row"},J={key:0,class:"success-msg"},K={key:1,class:"error-msg"},O={class:"button-row"},Q=["disabled"],W={class:"form-group"},X={class:"form-group"},Y={key:0,class:"error-msg"},Z={class:"button-row"},$=["disabled"],ee={__name:"FindPasswordPage",setup(l){const o=r(1),t=r(""),u=r(""),w=r(""),c=r(""),v=r(""),d=r(null),b=r(null),_=M();async function U(){if(!t.value||!u.value){alert("전화번호와 이메일을 모두 입력해주세요.");return}d.value=await D(t.value,u.value),d.value&&await E(u.value)}async function x(){b.value=await L(w.value,u.value)}const h=C(()=>t.value&&u.value&&d.value&&b.value);function P(){h.value&&(o.value=2)}const k=C(()=>c.value&&c.value===v.value);async function N(){k.value&&(await R(u.value,c.value),alert("비밀번호가 변경되었습니다!"),_.push("/auth/login"))}function g(){_.back()}return(se,s)=>(n(),F(S,null,{default:I(()=>[s[10]||(s[10]=e("h2",{class:"title"},"비밀번호 찾기",-1)),o.value===1?(n(),i("form",{key:0,class:"pw-form",onSubmit:V(P,["prevent"])},[e("div",T,[s[5]||(s[5]=e("label",null,"전화번호",-1)),f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value=a),class:"input",placeholder:"전화번호를 입력하세요"},null,512),[[m,t.value]])]),e("div",j,[s[6]||(s[6]=e("label",null,"이메일",-1)),e("div",q,[f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>u.value=a),class:"input",placeholder:"이메일을 입력하세요"},null,512),[[m,u.value]]),e("button",{type:"button",class:"btn",onClick:U},"인증")]),d.value===!1?(n(),i("div",z,"사용자의 정보와 일치하지 않습니다")):p("",!0),d.value===!0?(n(),i("div",A,"사용자 정보 확인 완료")):p("",!0)]),d.value===!0?(n(),i("div",G,[s[7]||(s[7]=e("label",null,"인증번호",-1)),e("div",H,[f(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>w.value=a),class:"input",placeholder:"인증번호를 입력하세요"},null,512),[[m,w.value]]),e("button",{type:"button",class:"btn",onClick:x},"확인")]),b.value===!0?(n(),i("div",J,"이메일 인증 완료")):p("",!0),b.value===!1?(n(),i("div",K,"인증번호가 일치하지 않습니다")):p("",!0)])):p("",!0),e("div",O,[e("button",{type:"button",class:"cancel-btn",onClick:g},"취소하기"),e("button",{type:"submit",class:"submit-btn",disabled:!h.value},"다음 단계",8,Q)])],32)):(n(),i("form",{key:1,class:"pw-form",onSubmit:V(N,["prevent"])},[e("div",W,[s[8]||(s[8]=e("label",null,"새 비밀번호",-1)),f(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>c.value=a),type:"password",class:"input",placeholder:"비밀번호를 입력하세요."},null,512),[[m,c.value]])]),e("div",X,[s[9]||(s[9]=e("label",null,"비밀번호 확인",-1)),f(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>v.value=a),type:"password",class:"input",placeholder:"비밀번호를 입력하세요."},null,512),[[m,v.value]]),c.value&&v.value&&c.value!==v.value?(n(),i("div",Y," 비밀번호가 일치하지 않습니다 ")):p("",!0)]),e("div",Z,[e("button",{type:"button",class:"cancel-btn",onClick:g},"취소하기"),e("button",{type:"submit",class:"submit-btn",disabled:!k.value},"수정",8,$)])],32))]),_:1,__:[10]}))}},ne=B(ee,[["__scopeId","data-v-0d1a36fe"]]);export{ne as default};
