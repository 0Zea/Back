import{x as o}from"./index-CYcq9FJg.js";const a=o.create({baseURL:"http://localhost:8080",timeout:1e4,withCredentials:!1}),s=async()=>{try{const t=localStorage.getItem("auth");if(t){const e=JSON.parse(t);if(e.token){const r=await o.post("http://localhost:8080/api/auth/refresh-token",{},{headers:{Authorization:`Bearer ${e.token}`}});if(r.data.success)return e.token=r.data.token,localStorage.setItem("auth",JSON.stringify(e)),r.data.token}}return null}catch(t){return console.error("토큰 갱신 실패:",t),null}};a.interceptors.request.use(t=>{const e=localStorage.getItem("auth");if(e){const r=JSON.parse(e);r.token&&(t.headers.Authorization=`Bearer ${r.token}`)}return t},t=>Promise.reject(t));a.interceptors.response.use(t=>t,async t=>{const e=t.config;if(t.response&&t.response.status===401&&!e._retry){e._retry=!0;const r=await s();if(r)return e.headers.Authorization=`Bearer ${r}`,a(e);localStorage.removeItem("auth"),window.location.href="/auth/login"}return Promise.reject(t)});export{a as i};
